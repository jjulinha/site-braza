// PORTFÓLIO: FILTRO COM ANIMAÇÃO, MODAL DE VÍDEO E REVEAL SIMILAR AO INDEX

// Aguarda carregamento do DOM
document.addEventListener('DOMContentLoaded', () => {

  // === 1. FILTRO COM ANIMAÇÃO ===
  const filterButtons = document.querySelectorAll('.filter-btn');
  const galleryItems = document.querySelectorAll('.gallery-item');

  filterButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      // Atualiza botão ativo
      filterButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const filter = btn.getAttribute('data-filter');

      galleryItems.forEach(item => {
        const category = item.getAttribute('data-category');
        const match = filter === 'all' || filter === category;

        if (match) {
          item.style.display = 'block';
          setTimeout(() => {
            item.classList.add('visible');
          }, 10);
        } else {
          item.classList.remove('visible');
          setTimeout(() => {
            item.style.display = 'none';
          }, 300);
        }
      });
    });
  });

  // === 2. MODAL DE VÍDEO ===
  const modal = document.createElement('div');
  modal.className = 'video-modal';
  modal.innerHTML = `
    <div class="video-content">
      <span class="close-video">&times;</span>
      <div class="video-wrapper">
        <iframe id="video-frame" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
    </div>
  `;
  document.body.appendChild(modal);

  const videoFrame = document.getElementById('video-frame');
  const closeModal = () => {
    modal.classList.remove('active');
    videoFrame.src = '';
  };
  modal.querySelector('.close-video').addEventListener('click', closeModal);
  modal.addEventListener('click', (e) => {
    if (e.target === modal) closeModal();
  });

  // Ativa modal ao clicar em item com data-video-id
  document.querySelectorAll('.gallery-item[data-video-id]').forEach(item => {
    item.addEventListener('click', () => {
      const videoId = item.getAttribute('data-video-id');
      if (videoId) {
        videoFrame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;
        modal.classList.add('active');
      }
    });
  });

  // === 3. SCROLL REVEAL SIMILAR AO INDEX ===
  const revealElements = document.querySelectorAll('.gallery-item');

  const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('reveal-active');
      }
    });
  }, {
    threshold: 0.1
  });

  revealElements.forEach(el => {
    revealObserver.observe(el);
  });

});
